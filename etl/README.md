# ETL

---

## Описание структуры:

Проект представляет собой реализацию ETL, в процессе которого данные о фильмах, хранящиеся в
PostgreSQL переносятся в БД Elasticsearch.

Процесс реализован с применением [Docker](https://www.docker.com/)-контейнеров:

1. [Elasticsearch](https://www.elastic.co) — NoSQL БД для полнотекстового поиска;
2. [PostgreSQL](https://www.postgresql.org/) — SQL база данных (БД);
3. [Redis](https://redis.io) — key-value БД (в проекте используется для хранения состояния переноса данных)
4. [Kibana](https://www.elastic.co/kibana/) - веб-интерфейс для взаимодействия с Elasticsearch
5. ETL-скрипт, реализованный на языке Python

Сервисы связаны между собой с помощью `docker compose` и зависят друг от друга.
Для упрощения работы в проекте предусмотрен Makefile.


##  Порядок запуска проекта:

Для быстрого и полного запуска проекта достаточно, находясь в корне репозитория,
выполнить команду `make full-up`.

Данная команда является составной и выполняет следующее:
1. создаст контейнеры на основе `docker-compose.dev.yml` файла,
а также именованные `volume`, предназначенные для хранения файлов, данных из БД и т.п..
2. запустит ETL-script для переноса данных в хранилище Elasticsearch


Каждое из описанных выше в списке действий может быть выполнено с помощью
отдельных команд:
1. `make dev-up`
2. `make load-data` 


Таким образом, можно запустить "_голый_" проект и выполнить только те команды,
которые требуется.

Больше команд прописано в `Makefile` 

## Требования для запуска проекта:
1. установленный и запущенный Docker Daemon
2. доступ к интернету
_3. не менее 1 Гб свободного пространства на жестком диске_


Данные запрашиваются из PostgreSQL и загружаются в Elasticsearch пачками размером не более 100 записей.
В процессе переноса данных отслеживаются изменения в PostgreSQL, и вносимые изменения переносятся 
в Elasticsearch. 
В качестве хранимого состояния используется дата последнего изменения фильма, жанра или персоны.
